#+title: Doom Emacs Config
#+PROPERTY: header-args :tangle config.el

* TABLE OF CONTENTS :toc:
- [[#intro][Intro]]
  - [[#splitting-and-buffers][Splitting and Buffers]]
  - [[#fonts][Fonts]]
  - [[#theming][Theming]]
  - [[#line-numbers][Line Numbers]]
  - [[#line-breaking][Line Breaking]]
  - [[#transparency][Transparency]]
  - [[#icons][Icons]]
- [[#colemak-mod-dh][Colemak Mod-DH]]
- [[#org-mode][Org-Mode]]
  - [[#links][Links]]
  - [[#tasks][Tasks]]
  - [[#colors][Colors]]
  - [[#pretty][Pretty]]
  - [[#journal][Journal]]
  - [[#super-agenda][Super Agenda]]
  - [[#blogging][Blogging]]
  - [[#org-roam][Org-Roam]]
  - [[#org-latex][Org-Latex]]
  - [[#auto-tangle][Auto-tangle]]
  - [[#org-chef][Org-Chef]]
  - [[#word-count][Word Count]]
- [[#latex-config][LaTeX Config]]
  - [[#bibtex][Bibtex]]
  - [[#snippets][Snippets]]
  - [[#cd-latex][CD-Latex]]
  - [[#folding][Folding]]
  - [[#pdf][PDF]]
  - [[#quiver][Quiver]]
- [[#dashboard][Dashboard]]
- [[#dired-ibuffer-sidebar][Dired-iBuffer sidebar]]
- [[#smaller-packages][Smaller Packages]]
  - [[#evil-goggles][Evil Goggles]]
  - [[#daemon][Daemon]]
  - [[#company][Company]]
  - [[#ispell][iSpell]]
  - [[#toggling][Toggling]]
  - [[#openers][Openers]]
  - [[#rainbow-mode][Rainbow Mode]]
  - [[#evil-snipe][Evil Snipe]]
  - [[#discord][Discord]]
  - [[#other][Other]]

* Intro
Some functionality uses this to identify you, e.g. GPG configuration, email
clients, file templates and snippets. It is optional.
#+begin_src elisp
(setq user-full-name "Lucas Kerbs"
      user-mail-address "lucaskerbs@gmail.com")
(setq default-directory "~/Library/CloudStorage/Dropbox/math")
#+end_src


We want to make some simple changes to basic functionality first
#+begin_src elisp
(setq undo-limit 100000000                         ; Raise undo-limit to 80Mb
      evil-want-fine-undo t                       ; By default while in insert all changes are one big blob. Be more granular
      truncate-string-ellipsis "‚Ä¶"                ; Unicode ellispis are nicer than "...", and also save /precious/ space
      password-cache-expiry nil                   ; I can trust my computers ... can't I?
      scroll-margin 3
      evil-move-cursor-back nil)                            ; It's nice to maintain a little margin
#+end_src

** Splitting and Buffers
First we set which buffer we want to see when splitting
#+begin_src elisp
(setq evil-vsplit-window-right t
      evil-split-window-below t)
#+end_src

Now we prompt for input when splitting
#+begin_src elisp
(defadvice! prompt-for-buffer (&rest _)
  :after '(evil-window-split evil-window-vsplit)
  (consult-buffer))
#+end_src
** Fonts
Doom exposes five (optional) variables for controlling fonts in Doom:
 - `doom-font' -- the primary font to use
 - `doom-variable-pitch-font' -- a non-monospace font (where applicable)
 - `doom-big-font' -- used for `doom-big-font-mode'; use this for
   presentations or streaming.
 - `doom-unicode-font' -- for unicode glyphs
 - `doom-serif-font' -- for the `fixed-pitch-serif' face
#+begin_src elisp
(setq doom-font (font-spec :family "JuliaMono" :size 15)
      doom-big-font (font-spec :family "JuliaMono" :size 24)
      doom-variable-pitch-font (font-spec :family "Ubuntu" :size 15)
      doom-unicode-font (font-spec :family "JuliaMono")
      doom-serif-font (font-spec :family "IBM Plex Mono" :size 22 :weight 'light))
(after! doom-themes
  (setq doom-themes-enable-bold t
        doom-themes-enable-italic t))
(custom-set-faces!
  '(font-lock-comment-face :slant italic)
  '(font-lock-keyword-face :slant italic))
#+end_src

** Theming
#+begin_src elisp
(setq doom-theme 'doom-monokai-classic)
;;(setq doom-theme 'doom-horizon)
(require 'ewal-doom-themes)
#+end_src

We also want some nice syntax highlighting!
#+begin_src elisp
(use-package! tree-sitter
  :config
  (require 'tree-sitter-langs)
  (global-tree-sitter-mode)
  (add-hook 'tree-sitter-after-on-hook #'tree-sitter-hl-mode))
#+end_src
*** Cleaning up the modeline

The encoding is standard, so hide is most of the time!
#+begin_src elisp
(defun doom-modeline-conditional-buffer-encoding ()
  "We expect the encoding to be LF UTF-8, so only show the modeline when this is not the case"
  (setq-local doom-modeline-buffer-encoding
              (unless (and (memq (plist-get (coding-system-plist buffer-file-coding-system) :category)
                                 '(coding-category-undecided coding-category-utf-8))
                           (not (memq (coding-system-eol-type buffer-file-coding-system) '(1 2))))
                t)))

(add-hook 'after-change-major-mode-hook #'doom-modeline-conditional-buffer-encoding)
#+end_src


** Line Numbers
This determines the style of line numbers in effect. If set to `nil', line
numbers are disabled. For relative line numbers, set this to `relative'.
#+begin_src elisp
(setq display-line-numbers-type 'relative)
#+end_src

** Line Breaking
Break lines (in general text-based documents) automatically at 80-ish lines
#+begin_src elisp
(add-hook 'text-mode-hook  'auto-fill-mode)
(setq-default fill-column 80)
#+end_src

** Transparency
Set the default transparency for active and inactive frames
#+begin_src elisp
(set-frame-parameter (selected-frame) 'alpha '(80 . 65))
(add-to-list 'default-frame-alist '(alpha . (80 . 65)))
#+end_src

** Icons
We want lots of icons!
#+begin_src elisp
(use-package all-the-icons
  :if (display-graphic-p))
;;(add-hook 'dired-mode-hook 'all-the-icons-dired-mode)
#+end_src
* Colemak Mod-DH
~evil-colemak-basics~ remaps a number standard evil keymaps. It doesn't play nice
with ~evil-tex~ so first we need some code for that. This code was given from
[[https://github.com/iyefrat/evil-tex/issues/14][Issue 9]] on the ~evil-tex~ page
#+begin_src elisp
(setq evil-tex-toggle-override-m nil)

(with-eval-after-load 'evil-tex
  (evil-define-key 'normal evil-tex-mode-map [remap evil-set-marker]
    (evil-tex-dispatch-single-key ?t #'evil-tex-read-and-execute-toggle
                                  'evil-tex-m-functions)))
#+end_src

Now we load ~evil-colemak-basics~ and create commads so that I can use the
=m-n-e-i= movements between windows. We also need to be able to scroll when we are
in pdf-view-mode.
#+begin_src elisp
(require 'evil-colemak-basics)
(use-package evil-colemak-basics
  :config
  (global-evil-colemak-basics-mode)
  )
  (define-key evil-window-map "n" 'evil-window-down)
  (define-key evil-window-map "N" 'evil-window-move-very-bottom)
  (define-key evil-window-map (kbd "C-S-n") 'evil-window-move-very-bottom)
  (define-key evil-window-map "e" 'evil-window-up)
  (define-key evil-window-map "E" 'evil-window-move-very-top)
  (define-key evil-window-map (kbd "C-S-e") 'evil-window-move-very-top)
  (define-key evil-window-map "m" 'evil-window-left)
  (define-key evil-window-map "M" 'evil-window-move-far-left)
  (define-key evil-window-map (kbd "C-S-m") 'evil-window-move-far-left)
  (define-key evil-window-map "i" 'evil-window-right)
  (define-key evil-window-map "I" 'evil-window-move-far-right)
  (define-key evil-window-map (kbd "C-S-i") 'evil-window-move-far-right)
  ;; Kreate new window
  (define-key evil-window-map "k" 'evil-window-new)
  (define-key evil-window-map "\C-k" 'evil-window-new)
  ;; Maximie window with SPC-w-J (this makes sense with my yabai/skhd config)
  (define-key evil-window-map "J" 'doom/window-maximize-buffer)
#+end_src

* Org-Mode
First we set the default Directories for ~org~ and ~org-roam~ as well as
configure the things to look a little pretty
#+begin_src elisp
(after! org
  (setq org-ellipsis " ‚ñº "
        org-log-repeat t
        org-log-done t
        org-log-into-drawer "LOGBOOK"
        org-hide-emphasis-markers t
        org-directory "~/Dropbox/Slipbox/"
        org-roam-directory "~/Dropbox/Slipbox/"))
#+end_src


If we have a named block in an org document, we can automatically reorder some
things with =smart-parenthesis=---we name a block and then insert it with =<<block
name>>=
#+begin_src elisp
(sp-local-pair
 '(org-mode)
 "<<" ">>"
 :actions '(insert))
#+end_src

When we have checklist, we want them to uncheck themselves when we repeat a
task. We need the following package and then we can add ~:RESET_CHECK_BOXES: t~ to
the ~:PROPERTIES:~ of any org task and it will do just that!
#+begin_src elisp
(add-to-list 'org-modules 'org-checklist)
(require 'org-checklist)
#+end_src

Above we hid the emphasis markers, but that gets annoying when we want to edit
things -- lets to the thing where they unfold as soon as you place the point
over something hidden
#+begin_src elisp
(after! org
(use-package! org-appear
  :hook (org-mode . org-appear-mode)
  :config
  (setq org-appear-autoemphasis t
        org-appear-autosubmarkers t
        org-appear-autolinks nil)
  ;; for proper first-time setup, `org-appear--set-elements'
  ;; needs to be run after other hooks have acted.
  (run-at-time nil nil #'org-appear--set-elements)))
#+end_src

** Links
Set it up so that we open url-schemes from ~keyboard maestro~
#+begin_src elisp
(after! org
    (setq org-link-abbrev-alist    ; This overwrites the default Doom org-link-abbrev-list
          '(("google" . "http://www.google.com/search?q=")
          ;("kmtrigger" . "")
         ( "wiki" . "https://en.wikipedia.org/wiki/")))
    (org-link-set-parameters "kmtrigger"  :follow (lambda (test) (browse-url (concat "kmtrigger://" test))))
)
#+end_src

** Tasks
TODO: Write about what this is supposed to be as soon as you know what its
supposed to be lol
#+begin_src elisp
(after! org
   (setq
       org-capture-todo-file "/gtd/inbox.org"
       org-archive-location  "~/Dropbox/Slipbox/gtd/archive.org::* From %s"

        org-todo-keywords '((sequence "TODO(t)" "PROJ(p)" "WAIT(w)" "|" "DONE(d)" "KILL(k)")
                            (sequence "BLOG(b)" "DRFT(d)" "|" "PBSH(p)"))
        org-agenda-files (list "~/Dropbox/Slipbox/"
                               "~/Dropbox/Slipbox/gtd/"
                               "~/Dropbox/Slipbox/course work/"))


  (setq org-refile-targets '(("~/Dropbox/Slipbox/gtd/todo.org" :maxlevel . 3)
                             ("~/Dropbox/Slipbox/gtd/tickler.org" :maxlevel . 3)
                             ("~/Dropbox/Slipbox/gtd/birthday_and_similar.org" :maxlevel . 1)
                             ("~/Dropbox/Slipbox/course work/" :maxlevel . 1 ))
        org-refile-allow-creating-parent-nodes t)
)
#+end_src


*** Handling Subtrees
These is a package that adds the following code, but I'll be honest... I'm not
sure how to add a package that with from the .el file so I'm just going to paste
the code here and hope it works. The package is called =org-reset-subtask=
#+begin_src elisp
(after! org

(setq org-default-properties (cons "RESET_SUBTASKS" org-default-properties))

(defun org-reset-subtask-state-subtree ()
  "Reset all subtasks in an entry subtree."
  (interactive "*")
  (if (org-before-first-heading-p)
      (error "Not inside a tree")
    (save-excursion
      (save-restriction
	(org-narrow-to-subtree)
	(org-show-subtree)
	(goto-char (point-min))
        (beginning-of-line 2)
        (narrow-to-region (point) (point-max))
        (org-map-entries
         '(when (member (org-get-todo-state) org-done-keywords)
            (org-todo (car org-todo-keywords))))
        ))))

(defun org-reset-subtask-state-maybe ()
  "Reset all subtasks in an entry if the `RESET_SUBTASKS' property is set"
  (interactive "*")
  (if (org-entry-get (point) "RESET_SUBTASKS")
      (org-reset-subtask-state-subtree)))

(defun org-subtask-reset ()
  (when (member org-state org-done-keywords) ;; org-state dynamically bound in org.el/org-todo
    (org-reset-subtask-state-maybe)
    (org-update-statistics-cookies t)))

(add-hook 'org-after-todo-state-change-hook 'org-subtask-reset)
)
#+end_src
** Colors
Shamelessly stolen from the dt config---this (should) make the colors in doom a
bit nicer
#+begin_src elisp
(after! org
(defun dt/org-colors-doom-one ()
  "Enable Doom One colors for Org headers."
  (interactive)
  (dolist
      (face
       '((org-level-1 1.1 "#51afef" ultra-bold)
         (org-level-2 1.1 "#c678dd" extra-bold)
         (org-level-3 1.1 "#98be65" bold)
         (org-level-4 1.1 "#da8548" semi-bold)
         (org-level-5 1.1 "#5699af" normal)
         (org-level-6 1.1 "#a9a1e1" normal)
         (org-level-7 1.1 "#46d9ff" normal)
         (org-level-8 1.1 "#ff6c6b" normal)))
    (set-face-attribute (nth 0 face) nil :font doom-variable-pitch-font :weight (nth 3 face) :height (nth 1 face) :foreground (nth 2 face)))
    (set-face-attribute 'org-table nil :font doom-font :weight 'normal :height 1.0 :foreground "#bfafdf"))

(defun dt/org-colors-dracula ()
  "Enable Dracula colors for Org headers."
  (interactive)
  (dolist
      (face
       '((org-level-1 1.1 "#8be9fd" ultra-bold)
         (org-level-2 1.1 "#bd93f9" extra-bold)
         (org-level-3 1.1 "#50fa7b" bold)
         (org-level-4 1.1 "#ff79c6" semi-bold)
         (org-level-5 1.1 "#9aedfe" normal)
         (org-level-6 1.1 "#caa9fa" normal)
         (org-level-7 1.1 "#5af78e" normal)
         (org-level-8 1.1 "#ff92d0" normal)))
    (set-face-attribute (nth 0 face) nil :font doom-variable-pitch-font :weight (nth 3 face) :height (nth 1 face) :foreground (nth 2 face)))
    (set-face-attribute 'org-table nil :font doom-font :weight 'normal :height 1.0 :foreground "#bfafdf"))

(defun dt/org-colors-gruvbox-dark ()
  "Enable Gruvbox Dark colors for Org headers."
  (interactive)
  (dolist
      (face
       '((org-level-1 1.1 "#458588" ultra-bold)
         (org-level-2 1.1 "#b16286" extra-bold)
         (org-level-3 1.1 "#98971a" bold)
         (org-level-4 1.1 "#fb4934" semi-bold)
         (org-level-5 1.1 "#83a598" normal)
         (org-level-6 1.1 "#d3869b" normal)
         (org-level-7 1.1 "#d79921" normal)
         (org-level-8 1.1 "#8ec07c" normal)))
    (set-face-attribute (nth 0 face) nil :font doom-variable-pitch-font :weight (nth 3 face) :height (nth 1 face) :foreground (nth 2 face)))
    (set-face-attribute 'org-table nil :font doom-font :weight 'normal :height 1.0 :foreground "#bfafdf"))

(defun dt/org-colors-monokai-pro ()
  "Enable Monokai Pro colors for Org headers."
  (interactive)
  (dolist
      (face
       '((org-level-1 1.1 "#78dce8" ultra-bold)
         (org-level-2 1.1 "#ab9df2" extra-bold)
         (org-level-3 1.1 "#a9dc76" bold)
         (org-level-4 1.1 "#fc9867" semi-bold)
         (org-level-5 1.1 "#ff6188" normal)
         (org-level-6 1.1 "#ffd866" normal)
         (org-level-7 1.1 "#78dce8" normal)
         (org-level-8 1.1 "#ab9df2" normal)))
    (set-face-attribute (nth 0 face) nil :font doom-variable-pitch-font :weight (nth 3 face) :height (nth 1 face) :foreground (nth 2 face)))
    (set-face-attribute 'org-table nil :font doom-font :weight 'normal :height 1.0 :foreground "#bfafdf"))

(defun dt/org-colors-nord ()
  "Enable Nord colors for Org headers."
  (interactive)
  (dolist
      (face
       '((org-level-1 1.1 "#81a1c1" ultra-bold)
         (org-level-2 1.1 "#b48ead" extra-bold)
         (org-level-3 1.1 "#a3be8c" bold)
         (org-level-4 1.1 "#ebcb8b" semi-bold)
         (org-level-5 1.1 "#bf616a" normal)
         (org-level-6 1.1 "#88c0d0" normal)
         (org-level-7 1.1 "#81a1c1" normal)
         (org-level-8 1.1 "#b48ead" normal)))
    (set-face-attribute (nth 0 face) nil :font doom-variable-pitch-font :weight (nth 3 face) :height (nth 1 face) :foreground (nth 2 face)))
    (set-face-attribute 'org-table nil :font doom-font :weight 'normal :height 1.0 :foreground "#bfafdf"))

(defun dt/org-colors-oceanic-next ()
  "Enable Oceanic Next colors for Org headers."
  (interactive)
  (dolist
      (face
       '((org-level-1 1.1 "#6699cc" ultra-bold)
         (org-level-2 1.1 "#c594c5" extra-bold)
         (org-level-3 1.1 "#99c794" bold)
         (org-level-4 1.1 "#fac863" semi-bold)
         (org-level-5 1.1 "#5fb3b3" normal)
         (org-level-6 1.1 "#ec5f67" normal)
         (org-level-7 1.1 "#6699cc" normal)
         (org-level-8 1.1 "#c594c5" normal)))
    (set-face-attribute (nth 0 face) nil :font doom-variable-pitch-font :weight (nth 3 face) :height (nth 1 face) :foreground (nth 2 face)))
    (set-face-attribute 'org-table nil :font doom-font :weight 'normal :height 1.0 :foreground "#bfafdf"))

(defun dt/org-colors-palenight ()
  "Enable Palenight colors for Org headers."
  (interactive)
  (dolist
      (face
       '((org-level-1 1.1 "#82aaff" ultra-bold)
         (org-level-2 1.1 "#c792ea" extra-bold)
         (org-level-3 1.1 "#c3e88d" bold)
         (org-level-4 1.1 "#ffcb6b" semi-bold)
         (org-level-5 1.1 "#a3f7ff" normal)
         (org-level-6 1.1 "#e1acff" normal)
         (org-level-7 1.1 "#f07178" normal)
         (org-level-8 1.1 "#ddffa7" normal)))
    (set-face-attribute (nth 0 face) nil :font doom-variable-pitch-font :weight (nth 3 face) :height (nth 1 face) :foreground (nth 2 face)))
    (set-face-attribute 'org-table nil :font doom-font :weight 'normal :height 1.0 :foreground "#bfafdf"))

(defun dt/org-colors-solarized-dark ()
  "Enable Solarized Dark colors for Org headers."
  (interactive)
  (dolist
      (face
       '((org-level-1 1.1 "#268bd2" ultra-bold)
         (org-level-2 1.1 "#d33682" extra-bold)
         (org-level-3 1.1 "#859900" bold)
         (org-level-4 1.1 "#b58900" semi-bold)
         (org-level-5 1.1 "#cb4b16" normal)
         (org-level-6 1.1 "#6c71c4" normal)
         (org-level-7 1.1 "#2aa198" normal)
         (org-level-8 1.1 "#657b83" normal)))
    (set-face-attribute (nth 0 face) nil :font doom-variable-pitch-font :weight (nth 3 face) :height (nth 1 face) :foreground (nth 2 face)))
    (set-face-attribute 'org-table nil :font doom-font :weight 'normal :height 1.0 :foreground "#bfafdf"))

(defun dt/org-colors-solarized-light ()
  "Enable Solarized Light colors for Org headers."
  (interactive)
  (dolist
      (face
       '((org-level-1 1.1 "#268bd2" ultra-bold)
         (org-level-2 1.1 "#d33682" extra-bold)
         (org-level-3 1.1 "#859900" bold)
         (org-level-4 1.1 "#b58900" semi-bold)
         (org-level-5 1.1 "#cb4b16" normal)
         (org-level-6 1.1 "#6c71c4" normal)
         (org-level-7 1.1 "#2aa198" normal)
         (org-level-8 1.1 "#657b83" normal)))
    (set-face-attribute (nth 0 face) nil :font doom-variable-pitch-font :weight (nth 3 face) :height (nth 1 face) :foreground (nth 2 face)))
    (set-face-attribute 'org-table nil :font doom-font :weight 'normal :height 1.0 :foreground "#bfafdf"))

(defun dt/org-colors-tomorrow-night ()
  "Enable Tomorrow Night colors for Org headers."
  (interactive)
  (dolist
      (face
       '((org-level-1 1.1 "#81a2be" ultra-bold)
         (org-level-2 1.1 "#b294bb" extra-bold)
         (org-level-3 1.1 "#b5bd68" bold)
         (org-level-4 1.1 "#e6c547" semi-bold)
         (org-level-5 1.1 "#cc6666" normal)
         (org-level-6 1.1 "#70c0ba" normal)
         (org-level-7 1.1 "#b77ee0" normal)
         (org-level-8 1.1 "#9ec400" normal)))
    (set-face-attribute (nth 0 face) nil :font doom-variable-pitch-font :weight (nth 3 face) :height (nth 1 face) :foreground (nth 2 face)))
    (set-face-attribute 'org-table nil :font doom-font :weight 'normal :height 1.0 :foreground "#bfafdf"))

;; Load our desired dt/org-colors-* theme on startup
(dt/org-colors-monokai-pro))
#+end_src

** Pretty
Now make things in org look a lot prettier
#+begin_src elisp
(after! org
(use-package! org-modern
  :hook (org-mode . org-modern-mode)
  :config
  (setq org-modern-star '("‚óâ" "‚óã" "‚ú∏" "‚úø" "‚ú§" "‚úú" "‚óÜ" "‚ñ∂")
        org-modern-table-vertical 1
        org-modern-table-horizontal 0.2
        org-modern-list '((43 . "‚û§")
                          (45 . "‚Äì")
                          (42 . "‚Ä¢"))
        org-modern-todo-faces
        '(("TODO" :inverse-video t :inherit org-todo)
          ("PROJ" :inverse-video t :inherit +org-todo-project)
          ("STRT" :inverse-video t :inherit +org-todo-active)
          ("[-]"  :inverse-video t :inherit +org-todo-active)
          ("HOLD" :inverse-video t :inherit +org-todo-onhold)
          ("WAIT" :inverse-video t :inherit +org-todo-onhold)
          ("[?]"  :inverse-video t :inherit +org-todo-onhold)
          ("KILL" :inverse-video t :inherit +org-todo-cancel)
          ("NO"   :inverse-video t :inherit +org-todo-cancel))
        org-modern-footnote
        (cons nil (cadr org-script-display))
        org-modern-block-fringe nil
        org-modern-block-name
        '((t . t)
          ("src" "¬ª" "¬´")
          ("example" "¬ª‚Äì" "‚Äì¬´")
          ("quote" "‚ùù" "‚ùû")
          ("export" "‚è©" "‚è™"))
        org-modern-progress nil
        org-modern-priority t
        org-modern-horizontal-rule (make-string 36 ?‚îÄ)
        org-modern-keyword
        '((t . t)
          ("title" . "ùôè")
          ("subtitle" . "ùô©")
          ("author" . "ùòº")
          ("email" . #("ÓÉ°" 0 1 (display (raise -0.14))))
          ("date" . "ùòø")
          ("property" . "‚ò∏")
          ("options" . "‚å•")
          ("startup" . "‚èª")
          ("macro" . "ùìú")
          ("bind" . #("ÓÖó" 0 1 (display (raise -0.1))))
          ("bibliography" . "ÔêÖ")
          ("print_bibliography" . #("Óïã" 0 1 (display (raise -0.1))))
          ("cite_export" . "ÔêÖ‚Æ≠")
          ("print_glossary" . #("Óïã·¥¨·∂ª" 0 1 (display (raise -0.1))))
          ("glossary_sources" . #("ÓÅì" 0 1 (display (raise -0.14))))
          ("include" . "‚á§")
          ("setupfile" . "‚áö")
          ("html_head" . "üÖ∑")
          ("html" . "üÖó")
          ("latex_class" . "üÑª")
          ("latex_class_options" . #("üÑªÓ¢∏" 1 2 (display (raise -0.14))))
          ("latex_header" . "üÖª")
          ("latex_header_extra" . "üÖª‚Å∫")
          ("latex" . "üÖõ")
          ("beamer_theme" . "üÑ±")
          ("beamer_color_theme" . #("üÑ±Óêä" 1 2 (display (raise -0.12))))
          ("beamer_font_theme" . "üÑ±ùêÄ")
          ("beamer_header" . "üÖ±")
          ("beamer" . "üÖë")
          ("attr_latex" . "üÑõ")
          ("attr_html" . "üÑó")
          ("attr_org" . "‚í™")
          ("call" . #("Óï¶" 0 1 (display (raise -0.15))))
          ("name" . "‚Åç")
          ("header" . "‚Ä∫")
          ("caption" . "‚ò∞")
          ("RESULTS" . "ü†∂")))
  (custom-set-faces! '(org-modern-statistics :inherit org-checkbox-statistics-todo))))
#+end_src
** Journal
Trying org-journal for daily research notes
#+begin_src elisp
(after! org
(setq org-journal-dir "~/Dropbox/Slipbox/journal/"))
#+end_src
** Super Agenda
In order to do task management, we want org agenda to be a little bit better. I
am not 100% sure what I want it to look like yet
#+begin_src elisp
;;(use-package! org-super-agenda
  ;;:after org-agenda
  ;;:init
  ;;(setq org-super-agenda-groups
        ;;'((:name "Today"
                                  ;;:time-grid t
                                  ;;:scheduled today)
                           ;;(:name "Due today"
                                  ;;:deadline today)
                           ;;(:name "Important"
                                  ;;:priority "A")
                           ;;(:name "Overdue"
                                  ;;:deadline past)
                           ;;(:name "Due soon"
                                  ;;:deadline future)
                           ;;(:name "Big Outcomes"
                                  ;;:tag "bo"))
  ;;:config
  ;;(org-super-agenda-mode))
#+end_src

** Blogging
I want to use ~ox-hugo~ in order to publish a blog (which I guess I have now). But
I don't think that I need to do anything with it yet here so for now this is
blank

** Org-Roam

First configure how often org-roam updates itself and the set the default header
for new org-roam documents
#+begin_src elisp
(after! org
(setq org-roam-db-update-method 'immediate)
(setq org-roam-capture-templates
      '(("s" "slipbox" plain "%?"
          :target (file+head "%<%Y%m%d%H%M%S>-${slug}.org"
                               "#+title: ${title}\n#+STARTUP: latexpreview\n")
                                :unnarrowed t
                                :jump-to-captured t))
      ))
#+end_src

Next we configure the side-window that is avaliable in org-roam buffers
#+begin_src elisp
(add-to-list 'display-buffer-alist
    '("\\*org-roam\\*"
        (display-buffer-in-side-window)
        (side . right)
        (slot . 0)
        (window-width . 0.25)
        (preserve-size . (t . nil))
        (window-parameters . ((no-other-window . t)
                              (no-delete-other-windows . t)))))
;; (setq org-roam-buffer nil)
#+end_src

** Org-Latex
We want ~cd-latex~ commands avaliable in ~org-mode~ as well as nicer latex highlighting
#+begin_src elisp
(add-hook 'org-mode-hook 'turn-on-org-cdlatex)
 (setq org-highlight-latex-and-related '(latex script entities))
#+end_src

Now turn on ~yas-snippets~ for LaTeX mode in org-buffers
#+begin_src elisp
(defun my-org-latex-yas ()
  (yas-minor-mode)
  (yas-activate-extra-mode 'latex-mode))
(add-hook 'org-mode-hook #'my-org-latex-yas)
#+end_src

Finally, we use ~org-fragtog~ to make the LaTeX snippets automatically toggle
previews
#+begin_src elisp
(add-hook 'org-mode-hook 'org-fragtog-mode)
#+end_src

We want to use a custom style file for our latex fragments, so lets source that
here. Since adding packages doesn't work with the default =dvipng= renderer, lets
switch to =imagemagick=
#+begin_src elisp
(setq org-preview-latex-default-process 'imagemagick)

(after! org
  (add-to-list 'org-latex-packages-alist '("" "/Users/lucaskerbs/Library/CloudStorage/Dropbox/math/Automation/style/lucastex" t))
)
#+end_src

** Auto-tangle
=org-auto-tangle= allows you to add the option =#+auto_tangle: t= in your Org file so that it automatically tangles when you save the document.
#+begin_src elisp
(use-package! org-auto-tangle
  :defer t
        :hook (org-mode . org-auto-tangle-mode))
#+end_src
** Org-Chef
I'm not sure if this is the way that I want to manage references, but I have a
good amount of sunk-cost at this point.
#+begin_src elisp
(use-package! org-chef
  :commands (org-chef-insert-recipe org-chef-get-recipe-from-url))
#+end_src

** Word Count
This is a little function I found on stack exchange that gets the word count in
a specific subheading
#+begin_src elisp
(require 'cl-lib)
(require 'org-element)

(defun org-element-parse-headline (&optional granularity visible-only)
  "Parse current headline.
GRANULARITY and VISIBLE-ONLY are like the args of `org-element-parse-buffer'."
  (let ((level (org-current-level)))
    (org-element-map
    (org-element-parse-buffer granularity visible-only)
    'headline
      (lambda (el)
    (and
     (eq (org-element-property :level el) level)
     (<= (org-element-property :begin el) (point))
     (<= (point) (org-element-property :end el))
     el))
      nil 'first-match 'no-recursion)))

(cl-defun org+-count-words-of-heading (&key (worthy '(paragraph bold italic underline code footnote-reference link strike-through subscript superscript table table-row table-cell))
                        (no-recursion nil))
  "Count words in the section of the current heading.
WORTHY is a list of things worthy to be counted.
This list should at least include the symbols:
paragraph, bold, italic, underline and strike-through.

If NO-RECURSION is non-nil don't count the words in subsections."
  (interactive (and current-prefix-arg
            (list :no-recursion t)))
  (let ((word-count 0))
    (org-element-map
    (org-element-contents (org-element-parse-headline))
    '(paragraph table)
      (lambda (par)
    (org-element-map
        par
        worthy
        (lambda (el)
          (cl-incf
           word-count
           (cl-loop
        for txt in (org-element-contents el)
        when (eq (org-element-type txt) 'plain-text)
        sum
        (with-temp-buffer
          (insert txt)
          (count-words (point-min) (point-max))))
           ))))
      nil nil (and no-recursion 'headline)
      )
      (when (called-interactively-p 'any)
      (message "Word count in section: %d" word-count))
    word-count))
#+end_src
* LaTeX Config
First we make all the TeX-modes play nice
#+begin_src elisp
(require 'latex)
(add-hook 'latex-mode-hook #'TeX-latex-mode)
#+end_src

+I don't like it when emacs adds the braces whenever I add =^= or =_= so that
gets disabled here+ I am trying it right now. There seem to be big pros and cons
to using this, but it is enabled right now.
#+begin_src elisp
(setq TeX-electric-sub-and-superscript t)
#+end_src

Okay so this makes it so that when you are in enumerate or itemize environments
and you do ~C-Enter~ it insert =\item=
#+begin_src elisp
(after! tex
  (map!
   :map LaTeX-mode-map
   :ei [C-return] #'LaTeX-insert-item)
  (setq TeX-electric-math '("\\(" . "")))
#+end_src

** Bibtex
Eventually I'm sure there will be lost more that has to do with my Bibtex
information. For now there is just setting the link to my main =.bib= file
#+begin_src elisp
(setq bibtex-completion-bibliography '("~/Dropbox/Biblio/main.bib"))
#+end_src

When searching with =ivy-bibtex=, we want hitting =RET= on a paper to inset the
LaTeX citation
#+begin_src elisp
(setq ivy-bibtex-default-action 'ivy-bibtex-insert-citation)
#+end_src

** Snippets
This gets certain snippets to expand automatically. Honestly I stole if from
somewhere and don't remember where/why.
#+begin_src elisp
(defun my-yas-try-expanding-auto-snippets ()
    (when (and (boundp 'yas-minor-mode) yas-minor-mode)
      (let ((yas-buffer-local-condition ''(require-snippet-condition . auto)))
        (yas-expand))))
  (add-hook 'post-command-hook #'my-yas-try-expanding-auto-snippets)
#+end_src

The package ~laas~ or =latex-auto-activating-snippets= provides the ability to
automatically expand certain snippets with minimal/no input from me.
#+begin_src elisp
(use-package! laas
  :hook (LaTeX-mode . laas-mode)
  ;; if you want it in org-mode too
  :hook (org-mode . laas-mode)
  :config
  (aas-set-snippets 'laas-mode
                    ;; set condition!
                    :cond #'texmathp ; expand only while in math
                    ;;"supp" "\\supp"
                    ;; bind to functions!
                    ;;        (yas-expand-snippet "\\frac{$1}{$2}$0"))
                    "Span" (lambda () (interactive)
                             (yas-expand-snippet "\\Span($1)$0"))))
#+end_src

** CD-Latex
~cd-latex~ is a package that turn the =`= key into a leader key for a bunch of
LaTeX commads. By default Doom turns off it overloading =TAB=, but I've grown
used to it:
#+begin_src elisp
(map! :map cdlatex-mode-map
    :i "TAB" #'cdlatex-tab)
#+end_src

Now we add to the settings under the =`= leader:
#+begin_src elisp
(setq cdlatex-math-symbol-alist
 '(
   ( ?c  ("\\chi"           "\\circ"          "\\cos"))
   ( ?_  ("\\downarrow"     ""                "\\inf"))
   ( ?2  ("^2"              "\\sqrt{?}"       ""     ))
   ( ?3  ("^3"              "\\sqrt[3]{?}"    ""     ))
   ( ?e  ("\\varepsilon"    "\\epsilon"       "\\exp"))
   ( ?+  ("\\cup"           "\\oplus"         ""     ))
   ( ?x  ("\\xi"            "\\otimes"        ""     ))
   ( ?U  ("\\Upsilon"       "\\cup"           "\\bigcup"     ))
   ( ?N  ("\\nabla"         "\\cap"           "\\bigcap")))
 cdlatex-math-modify-alist
 '( ;; my own stuff
     (?B    "\\mathbb"        nil          t    nil  nil)
     (?a    "\\abs"           nil          t    nil  nil)
     (?S    "\\mathscr"       nil          t    nil  nil)
     (?s    "\\sqrt"          nil          t    nil  nil)
     (?n    "\\norm"          nil          t    nil  nil)
     (?F    "\\mathfrak"      nil          t    nil  nil)
     ))

(setq cdlatex-make-sub-superscript-roman-if-pressed-twice t)
#+end_src

** Folding

This code should make the delimiters take up a lot less visual space!
#+begin_src elisp
;; Making \( \) less visible
(defface unimportant-latex-face
  '((t :inherit font-lock-comment-face :weight extra-light))
  "Face used to make \\(\\), \\[\\] less visible."
  :group 'LaTeX-math)

(font-lock-add-keywords
 'latex-mode
 `(("\\\\[]()[]" 0 'unimportant-latex-face prepend))
 'end)
#+end_src

This is just a thing that I am trying---it folds a bunch of the LaTeX commands
to just give symbols when you aren't editing that section
#+begin_src elisp
(after! latex
  (setcar (assoc "‚ãÜ" LaTeX-fold-math-spec-list) "‚òÖ")) ;; make \star bigger
(setq TeX-fold-math-spec-list
      `(;; missing/better symbols
        ("‚â§" ("le"))
        ("‚â•" ("ge"))
        ("‚â†" ("ne"))
        ;; convenience shorts -- these don't work nicely ATM
        ;; ("‚Äπ" ("left"))
        ;; ("‚Ä∫" ("right"))
        ;; private macros
        ("‚ÑÇ" ("CC"))
        ("ùîº" ("EE"))
        ("‚Ñç" ("HH"))
        ("‚Ñù" ("RR"))
        ("ùïä" ("SS"))
        ("ùïã" ("TT"))
        ("‚Ñï" ("NN"))
        ("‚Ñô" ("PP"))
        ("‚Ñö" ("QQ"))
        ("‚Ñ§" ("ZZ"))
        ("ùëë" ("dd"))
        ;; known commands
        ("" ("phantom"))
        (,(lambda (num den) (if (and (TeX-string-single-token-p num) (TeX-string-single-token-p den))
                                (concat num "Ôºè" den)
                              (concat "‚ù™" num "Ôºè" den "‚ù´"))) ("frac"))
        (,(lambda (arg) (concat "‚àö" (TeX-fold-parenthesize-as-necessary arg))) ("sqrt"))
        (,(lambda (arg) (concat "‚≠°" (TeX-fold-parenthesize-as-necessary arg))) ("vec"))
        ("‚Äò{1}‚Äô" ("text"))
        ;; private commands
        ("|{1}|" ("abs"))
        ("‚Äñ{1}‚Äñ" ("norm"))
        ("‚åä{1}‚åã" ("floor"))
        ("‚åà{1}‚åâ" ("ceil"))
        ("‚åä{1}‚åâ" ("round"))
        ("ùëë{1}/ùëë{2}" ("dv"))
        ("‚àÇ{1}/‚àÇ{2}" ("pdv"))
        ;; fancification
        ("{1}" ("mathrm"))
        (,(lambda (word) (string-offset-roman-chars 119743 word)) ("mathbf"))
        (,(lambda (word) (string-offset-roman-chars 119951 word)) ("mathcal"))
        (,(lambda (word) (string-offset-roman-chars 120003 word)) ("mathfrak"))
        (,(lambda (word) (string-offset-roman-chars 120055 word)) ("mathbb"))
        (,(lambda (word) (string-offset-roman-chars 120159 word)) ("mathsf"))
        (,(lambda (word) (string-offset-roman-chars 120367 word)) ("mathtt"))
        )
      TeX-fold-macro-spec-list
      '(
        ;; as the defaults
        ("[f]" ("footnote" "marginpar"))
        ("[c]" ("cite"))
        ("[l]" ("label"))
        ("[r]" ("ref" "pageref" "eqref"))
        ("[i]" ("index" "glossary"))
        ("..." ("dots"))
        ("{1}" ("emph" "textit" "textsl" "textmd" "textrm" "textsf" "texttt"
                "textbf" "textsc" "textup"))
        ;; tweaked defaults
        ("¬©" ("copyright"))
        ("¬Æ" ("textregistered"))
        ("‚Ñ¢"  ("texttrademark"))
        ("[1]:||‚ñ∫" ("item"))
        ("‚ù°‚ù°‚ÄÜ{1}" ("part" "part*"))
        ("‚ù°‚ÄÜ{1}" ("chapter" "chapter*"))
        ("¬ß‚ÄÜ{1}" ("section" "section*"))
        ("¬ß¬ß‚ÄÜ{1}" ("subsection" "subsection*"))
        ("¬ß¬ß¬ß‚ÄÜ{1}" ("subsubsection" "subsubsection*"))
        ("¬∂‚ÄÜ{1}" ("paragraph" "paragraph*"))
        ("¬∂¬∂‚ÄÜ{1}" ("subparagraph" "subparagraph*"))
        ;; extra
        ("‚¨ñ‚ÄÜ{1}" ("begin"))
        ("‚¨ó‚ÄÜ{1}" ("end"))
        ))

(defun string-offset-roman-chars (offset word)
  "Shift the codepoint of each character in WORD by OFFSET with an extra -6 shift if the letter is lowercase"
  (apply 'string
         (mapcar (lambda (c)
                   (string-offset-apply-roman-char-exceptions
                    (+ (if (>= c 97) (- c 6) c) offset)))
                 word)))

(defvar string-offset-roman-char-exceptions
  '(;; lowercase serif
    (119892 .  8462) ; ‚Ñé
    ;; lowercase caligraphic
    (119994 . 8495) ; ‚ÑØ
    (119996 . 8458) ; ‚Ñä
    (120004 . 8500) ; ‚Ñ¥
    ;; caligraphic
    (119965 . 8492) ; ‚Ñ¨
    (119968 . 8496) ; ‚Ñ∞
    (119969 . 8497) ; ‚Ñ±
    (119971 . 8459) ; ‚Ñã
    (119972 . 8464) ; ‚Ñê
    (119975 . 8466) ; ‚Ñí
    (119976 . 8499) ; ‚Ñ≥
    (119981 . 8475) ; ‚Ñõ
    ;; fraktur
    (120070 . 8493) ; ‚Ñ≠
    (120075 . 8460) ; ‚Ñå
    (120076 . 8465) ; ‚Ñë
    (120085 . 8476) ; ‚Ñú
    (120092 . 8488) ; ‚Ñ®
    ;; blackboard
    (120122 . 8450) ; ‚ÑÇ
    (120127 . 8461) ; ‚Ñç
    (120133 . 8469) ; ‚Ñï
    (120135 . 8473) ; ‚Ñô
    (120136 . 8474) ; ‚Ñö
    (120137 . 8477) ; ‚Ñù
    (120145 . 8484) ; ‚Ñ§
    )
  "An alist of deceptive codepoints, and then where the glyph actually resides.")

(defun string-offset-apply-roman-char-exceptions (char)
  "Sometimes the codepoint doesn't contain the char you expect.
Such special cases should be remapped to another value, as given in `string-offset-roman-char-exceptions'."
  (if (assoc char string-offset-roman-char-exceptions)
      (cdr (assoc char string-offset-roman-char-exceptions))
    char))

(defun TeX-fold-parenthesize-as-necessary (tokens &optional suppress-left suppress-right)
  "Add ‚ù™ ‚ù´ parenthesis as if multiple LaTeX tokens appear to be present"
  (if (TeX-string-single-token-p tokens) tokens
    (concat (if suppress-left "" "‚ù™")
            tokens
            (if suppress-right "" "‚ù´"))))

(defun TeX-string-single-token-p (teststring)
  "Return t if TESTSTRING appears to be a single token, nil otherwise"
  (if (string-match-p "^\\\\?\\w+$" teststring) t nil))
#+end_src

** PDF
+Once we have a latex document we like, we want it to be able to open the pdf in+
=sioyek=, +a customizable pdf viewer: -- this is broken right nwo and I'm not
exactly sure why. An upcoming auctex release will add+ =sioyek= +as a defaul option
and that will make life easier+
#+begin_src elisp
    ;(setq TeX-view-program-list
     ;'("sioyek"
       ;("/Applications/sioyek.app/Contents/MacOS/sioyek %o"
        ;(mode-io-correlate
         ;,(concat
           ;" --forward-search-file \"%b\""
           ;" --forward-search-line %n"
           ;" --inverse-search \"emacsclient +%2 %1\"")))
       ;"sioyek"))
    ;(add-to-list 'TeX-view-program-selection
                 ;'(output-pdf "sioyek"))
#+end_src

As of now I am using =pdf-view= as my pdf reader. This sets up synctex and all
that.

#+begin_src elisp
(add-hook 'LaTeX-mode-hook 'TeX-PDF-mode)
(add-hook 'LaTeX-mode-hook 'TeX-source-correlate-mode)
(setq TeX-source-correlate-method 'synctex)

(setq TeX-view-program-selection '((output-pdf "PDF Tools"))
      TeX-source-correlate-start-server t)

(add-hook 'TeX-after-compilation-finished-functions #'TeX-revert-document-buffer)

(add-hook 'LaTeX-mode-hook (lambda ()
  (push
    '("latexmk" "latexmk -pvc -synctex=1 -pdf %s" TeX-run-TeX nil t
      :help "Run latexmk on file")
    TeX-command-list)))
(add-hook 'TeX-mode-hook '(lambda () (setq TeX-command-default "latexmk")))
#+end_src

*** TODO Get evil navigation in pdf-view
It just started working one day... I will not question the emacs gods. Since
this is the pdf area I'm going to set it to display pdf's in a nice way
#+begin_src elisp
(add-hook 'pdf-view-mode-hook #'pdf-view-themed-minor-mode)
#+end_src

** Quiver
I use quiver for a lot of my commutative diagrams. This little snippet allows me
to edit the thing in a nice way?
[taken from https://github.com/varkor/quiver/issues/148]
#+begin_src elisp
(defun replace-quiver-diagram ()
  "Extracts the quiver URL from the diagram under cursor and runs it in browser. Selects the diagram."
  (interactive)
        (let ((start 0)
              (end 0)
              (url-start 0)
              (url-end 0)
              (url ""))
    (save-excursion
      (save-excursion
        (re-search-backward "% https://q.uiver.app" nil)
        (setq url-start (+ 2 (point)))
        (beginning-of-line)
        (setq start (point))
      (save-excursion
	    (re-search-forward "\\\\end{tikzcd}" nil)
        (setq end (point)))
      (save-excursion
        (goto-char url-start)
        (re-search-forward "\n" nil)
        (setq url-end (- (point) 1))
        (skip-chars-forward " ")
        ;; If the next two symbols after new line, up to whitespace,
        ;; are "\[", modify the `end` value to be after \].
        (when (string= "[" (string (char-after (+ 1 (point)))))
          (setq end (+ 2 end))))
      (setq url (buffer-substring-no-properties url-start url-end))
      (start-process "" nil
                     ;; Edit this line to change the browser.
                     "flatpak" "run" "org.chromium.Chromium" url)))
    (goto-char start)
    (push-mark end t t)))

(add-hook 'TeX-mode-hook (lambda ()
                           (interactive)
                           (define-key TeX-mode-map (kbd "C-x q") 'replace-quiver-diagram)))
#+end_src
* Dashboard
This package makes a nice(r) splash screen than the one that comes with the
default doom. Just in case, let's set the ~doom-dashboard~ image to the one we
want
#+begin_src elisp
(setq fancy-splash-image "~/.doom.d/cute-doom/doom_512.png")
#+end_src

Now we set all the rest of the startup-dashboard
#+begin_src elisp
(use-package dashboard
  :init      ;; tweak dashboard config before loading it
  (setq dashboard-set-heading-icons t)
  (setq dashboard-set-file-icons t)
  (setq dashboard-set-navigator t)
  (setq dashboard-banner-logo-title "\nKEYBINDINGS:\
\nFind file               (SPC .)     \
Open buffer list    (SPC b i)\
\nFind recent files       (SPC f r)   \
\nOpen dired file manager (SPC d d)   \
List of keybindings (SPC h b b)")
  ;;(setq dashboard-startup-banner 'logo) ;; use standard emacs logo as banner
  (setq dashboard-startup-banner "~/.doom.d/cute-doom/doom_512.png")
  (setq dashboard-banner-logo-title "Journey Before Destination!")
  (setq dashboard-center-content nil) ;; set to 't' for centered content
  (setq dashboard-items '((recents . 5)
                          (bookmarks . 5)
                          (projects . 3)
                          (registers . 5)))
   :config
   (dashboard-setup-startup-hook)
   (dashboard-modify-heading-icons '((recents . "file-text")
                                     (bookmarks . "book"))))
#+end_src

We want a simple binding to do to the dashboard

In the case that we are loading an ~emacsclient~ window, we want to open the
dashboard. Right now it doesn't work right all the time.
#+begin_src elisp
(setq initial-buffer-choice (lambda () (get-buffer "*dashboard*")))
(setq doom-fallback-buffer-master "*dashboard*")
#+end_src

Command to make new buffers do the thing that we want
#+begin_src elisp
 (defun new-workspace ()
   "Open a new workspace and open the dashboard at the same time"
   (interactive)
   (+workspace/new)
   (dashboard-refresh-buffer))
#+end_src

* Dired-iBuffer sidebar
Another thing that I am playing with. We create a side-bar with a ~dired~ and
~ibuffer~ window.
#+begin_src elisp
(use-package ibuffer-sidebar
  :load-path "~/.emacs.d/fork/ibuffer-sidebar"
  :commands (ibuffer-sidebar-toggle-sidebar)
  :config
  (setq ibuffer-sidebar-use-custom-font t)
  (setq ibuffer-sidebar-face `(:family "Helvetica" :height 140)))
(use-package dired-sidebar
  :bind (("C-x C-n" . dired-sidebar-toggle-sidebar))
  :commands (dired-sidebar-toggle-sidebar)
  :init
  (add-hook 'dired-sidebar-mode-hook
            (lambda ()
              (unless (file-remote-p default-directory)
                (auto-revert-mode))))
  :config
  (push 'toggle-window-split dired-sidebar-toggle-hidden-commands)
  (push 'rotate-windows dired-sidebar-toggle-hidden-commands)

  (setq dired-sidebar-subtree-line-prefix "__")
  (setq dired-sidebar-use-term-integration t)
  (setq dired-sidebar-use-custom-font t))
(defun sidebar-toggle ()
  "Toggle both `dired-sidebar' and `ibuffer-sidebar'."
  (interactive)
  (dired-sidebar-toggle-sidebar)
  (ibuffer-sidebar-toggle-sidebar))
#+end_src

* Smaller Packages
** Evil Goggles
This package adds a little highlight whenever you do a big-boy change
#+begin_src elisp
(use-package evil-goggles
  :init
  (setq evil-goggles-duration 0.1
        evil-goggles-pulse nil ; too slow
        ;; evil-goggles provides a good indicator of what has been affected.
        ;; delete/change is obvious, so I'd rather disable it for these.
        evil-goggles-enable-delete t
        evil-goggles-enable-change t)
  :config
  (evil-goggles-mode)
  (evil-goggles-use-diff-faces))
 #+end_src

** Daemon
We want a simple command to save all buffers and then shutdown the daemon
#+begin_src elisp
(defun server-shutdown ()
  "Save buffers, Quit, and Shutdown (kill) server"
  (interactive)
  (save-some-buffers)
  (kill-emacs)
  )
#+end_src

** Company
Comany is a completion engine. It is really nice but it gets in the way
#+begin_src elisp
(after! company
  (setq company-idle-delay 1.5
       company-minimum-prefix-length 5))
#+end_src

** iSpell
Spell-check needs a home
#+begin_src elisp
(setq ispell-program-name "/usr/local/bin/ispell")
#+end_src

** Toggling
Some simple code that adds things under ~leader-t~ to toggle various things
(once again, this code is stolen and I'm not 100% sure everything it does)
#+begin_src elisp
(map! :leader
      :desc "Comment or uncomment lines" "TAB TAB" #'comment-line
      (:prefix ("t" . "toggle")
       :desc "Toggle line numbers" "l" #'doom/toggle-line-numbers
       :desc "Toggle line highlight in frame" "h" #'hl-line-mode
       :desc "Toggle line highlight globally" "H" #'global-hl-line-mode
       :desc "Toggle truncate lines" "t" #'toggle-truncate-lines))
#+end_src

** Openers
Keybindings to open files that I work with all the time using the find-file
command, which is the interactive file search that opens with ~C-x C-f~ in GNU
Emacs or ~SPC f f~ in Doom Emacs.  These keybindings use find-file
non-interactively since we specify exactly what file to open.  The format I use
for these bindings is ~SPC =~ plus ~key~ since Doom Emacs does not use ~SPC =~.
#+begin_src elisp
(map! :leader
      (:prefix ("=" . "open file")
       :desc "Edit agenda file" "a" #'(lambda () (interactive) (find-file "~/Org/agenda.org"))
       :desc "Edit doom config.org" "c" #'(lambda () (interactive) (find-file "~/.doom.d/config.org"))
       :desc "Edit doom init.el" "i" #'(lambda () (interactive) (find-file "~/.doom.d/init.el"))
       :desc "Edit doom packages.el" "p" #'(lambda () (interactive) (find-file "~/.doom.d/packages.el"))
       :desc "Edit yabai config" "y" #'(lambda () (interactive) (find-file "~/.config/yabai/README.org"))
       :desc "Open todo.org" "t" #'(lambda () (interactive) (find-file "~/Dropbox/Slipbox/gtd/todo.org"))
       :desc "Open inbox.org" "n" #'(lambda () (interactive) (find-file "~/Dropbox/Slipbox/gtd/inbox.org"))
       :desc "Open review.org" "r" #'(lambda () (interactive) (find-file "~/Dropbox/Slipbox/gtd/review.org"))))
#+end_src

** Rainbow Mode
Get those good good colors!
#+begin_src elisp
(define-globalized-minor-mode global-rainbow-mode rainbow-mode
  (lambda () (rainbow-mode 1)))
(global-rainbow-mode 1 )
#+end_src

** Evil Snipe
This is a new thing (as of 4-9-22). It seems like a good way to navigate round
the buffer but I want a little larger range for my sniping
#+begin_src elisp
(after! evil-snipe
  (setq evil-snipe-scope 'visible
        evil-snipe-spillover-scope 'whole-visible))
#+end_src

** Discord
The package =elcord= allows integration with the Discord /Rich Context/ feature (or
whatever its called). Lets turn that on
#+begin_src elisp
;(require 'elcord)
;(elcord-mode)
;(setq elcord-use-major-mode-as-icon t)
#+end_src
** Other
These are things that I added at one point but I'm really not sure what is going
on
#+begin_src elisp
(setq projectile-project-search-path '("~/Dropbox/math/"
                                       "~/Dropbox/PhD Applications/"
                                       "~/Projects/"))
#+end_src

I get the following error from *something*.
#+BEGIN_QUOTE
Warning (defvaralias): Overwriting value of ‚Äòwoman-topic-history‚Äô by aliasing to ‚ÄòMan-topic-history‚Äô
#+END_QUOTE
I googled it and it said to add this line
#+begin_src elisp
(add-to-list 'warning-suppress-types '(defvaralias))
#+end_src
